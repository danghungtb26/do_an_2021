
jQuery(document).ready(function() {
    openSearchM($("#header-search"));
    openFieldFixed();
    $('a[href\x3d"#mobile-menu"]').on("click", function() {
        var a = $(this),
            c = $($(this).attr("href"));
        c.hasClass("active") ? (a.removeClass("active"), c.removeClass("active"), $("body").removeClass("mmenu-open")) : (a.addClass("active"), c.addClass("active"), $("body").addClass("mmenu-open"));
        return !1
    });
    $(".list-personal__item").click(function(a) {
        var b = $(this),
            c = $(this).position();
        if ($(this).hasClass("open")) {
            if (!$(a.target).is(".list-personal__item--info, .list-personal__item--info *")) {
                $(this).removeClass("open");
                var d = this;
                setTimeout(function() {
                    b.find(".list-personal__item--info").fadeOut(200)
                }, 200);
                setTimeout(function() {
                    $(d).removeClass("open item-open-left item-open-right item-open-down item-open-up")
                }, 400)
            }
        } else {
            $(".list-personal__item").find(".list-personal__item--info").hide();
            $(".list-personal__item").removeClass("open item-open-left item-open-right item-open-down item-open-up");
            $(this).addClass("open");
            var f;
            a = Math.floor(c.top);
            f = Math.floor(c.left) + 50;
            var h = $(window).width() / 2,
                k = $(window).scrollTop() +
                $(window).height() / 2,
                G = Math.floor($(this).parents(".list-personal__row").position().top) - $("#header").outerHeight(),
                I = Math.floor(G + $(this).parents(".list-personal__row").outerHeight() / 2),
                M = Math.floor($(this).outerHeight(!0));
            767 < $(window).width() ? (f = f > h ? "left" : "right", $(this).addClass("item-open-" + f)) : (f = f > h ? "left" : "right", c = a === G ? "down" : Math.round(a + M) === I ? "up" : c.top > k ? "up" : "down", $(this).addClass("item-open-" + f).addClass("item-open-" + c));
            setTimeout(function() {
                    b.find(".list-personal__item--info")
                },
                200)
        }
    });
    
    
    
    var k = $(window).width() - 30,
        f = $(".list-personal__item").length,
        h = 6 * Math.floor(k / 80),
        c = h;
    $(".list-personal__item").hide();
    $(".list-personal__item:lt(" + h + ")").show();
    $(".list-personal__viewmore").on("click", function() {
        c = c + h <= f ? c + h : f;
        $(".list-personal__item:lt(" + c + ")").show();
        c == f && $(".list-personal__viewmore").remove()
    });
    $(".menu ul li a, #mobile-menu ul li a").on("click",
        function() {
            console.log(window.location.pathname);
            if ("/" != window.location.pathname) {
                var a = $(this).attr("href");
                if (["#contribute", "#implementation-project", "#fields"].includes(a)) return window.location.href = "/", scrollBlock(a), !1
            } else if (a = $(this).attr("href"), ["#contribute", "#implementation-project", "#fields"].includes(a)) return scrollBlock(a), !1
        });
    var a = location.hash;
    "" != a && (history.pushState("", document.title, window.location.pathname), $(window).on("load", function() {
        $("html, body").animate({
            scrollTop: $(a).offset().top -
                $("#header").height()
        }, 500)
    }))
});

function sticky() {
    0 < $(window).scrollTop() ? $("#header").addClass("sticky") : ($("#header").removeClass("sticky"), $(".overlay").remove())
}

function stickyMobile() {
    0 > $("#page").offset().top ? $("#header").addClass("sticky") : ($("#header").removeClass("sticky"), closeSearchM())
}

function openSearchM(d) {
    $(d).on("submit", function() {
        var k = $(window).width(),
            f = $(d).parent(".search");
        if (480 > k) {
            if ("" == f.find("input").val() || 2 > f.find("input").val().length) return f.hasClass("open") && alert("Bạn cần nhập tối thiểu 2 kí tự chuỗi cần tìm kiếm!"), f.addClass("open"), f.find("input").focus(), 0 == $(".overlay").length && $("body").prepend('\x3cdiv class\x3d"overlay" onclick\x3d"closeSearchM()"\x3e\x3c/div\x3e'), !1;
            if ("" != f.find("input").val()) {
                if (f.hasClass("open")) return !0;
                f.toggleClass("open");
                f.find("input").focus();
                return !1
            }
        } else return "" == f.find("input").val() || 2 > f.find("input").val().length ? (alert("Bạn cần nhập tối thiểu 2 kí tự chuỗi cần tìm kiếm!"), !1) : !0
    })
}

function closeSearchM() {
    480 > $(window).width() && ($(".overlay").remove(), $("#header-search").parent(".search").removeClass("open"))
}

function openFieldFixed() {
    var d = $(".list-fields-fixed");
    $(".list-fields-fixed button").on("click", function() {
        d.hasClass("open") ? (d.children("ul").find("span").animate({
            opacity: "0"
        }, "200"), setTimeout(function() {
            d.removeClass("open").animate({
                paddingTop: "0px"
            }, "500");
            d.children("ul").css({
                overflow: "hidden"
            }).animate({
                maxHeight: "0"
            }, "500");
            $(".bg-field-fixed").animate({
                opacity: "0"
            }, "500")
        }, 200), setTimeout(function() {
            $(".bg-field-fixed").remove()
        }, 800)) : ($("body").append('\x3cdiv class\x3d"bg-field-fixed" onclick\x3d"closeField()" style\x3d"opacity: 0;"\x3e\x3c/div\x3e'),
            $(".bg-field-fixed").animate({
                opacity: "1"
            }, "500"), d.addClass("open").animate({
                paddingTop: "26px"
            }, "500"), d.children("ul").animate({
                maxHeight: "500px"
            }, "500"), setTimeout(function() {
                d.children("ul").css({
                    overflow: "initial"
                });
                d.children("ul").find("span").animate({
                    opacity: "1"
                }, "300")
            }, 500))
    })
}
